team <- rbind(team,df1,df2,df3,df4,df5,df6,df7,df8,df9,df10,df11,df12,df13,
df14,df15,df16,df17,df18,df19,df20,df21,df22,df23,df24,df25,df26,
df27,df28,df29,df30,df31,df32,df33,df34,df35,df36,df37,df38,df39,df40)
return(team)
}
### Merging all the years ###
bulls <- merger(bulls.reg90,bulls.reg91,bulls.reg92,bulls.reg93,bulls.reg94,
bulls.reg95,bulls.reg96,bulls.reg97,bulls.reg98,bulls.post90,
bulls.post91,bulls.post92,bulls.post93,bulls.post94,bulls.post95,
bulls.post96,bulls.post97,bulls.post98)
caveliers <- merger(caveliers.reg10,caveliers.reg15,caveliers.reg16,caveliers.reg17,
caveliers.reg18,caveliers.post10,caveliers.post15,
caveliers.post16,caveliers.post17,caveliers.post18)
celtics <- merger(celtics.reg85,celtics.reg86,celtics.reg87,celtics.reg88,celtics.reg89,
celtics.reg02,celtics.reg03,celtics.reg04,celtics.reg05,celtics.reg08,
celtics.reg09,celtics.post85,celtics.post86,celtics.post87,celtics.post88,
celtics.post89,celtics.post02,celtics.post03,celtics.post04,celtics.post05,
celtics.post08,celtics.post09)
heat <- merger(heat.reg10,heat.reg11,heat.reg12,heat.reg13,heat.reg14,heat.reg16,
heat.reg18,heat.post10,heat.post11,heat.post12,heat.post13,heat.post14,
heat.post16,heat.post18)
jazz <- merger(jazz.reg90,jazz.reg91,jazz.reg92,jazz.reg93,jazz.reg94,jazz.reg95,
jazz.reg96,jazz.reg97,jazz.reg98,jazz.reg99,jazz.post90,jazz.post91,
jazz.post92,jazz.post93,jazz.post94,jazz.post95,jazz.post96,jazz.post97,
jazz.post98,jazz.post99)
lakers <- merger(lakers.reg85,lakers.reg86,lakers.reg87,lakers.reg88,lakers.reg89,
lakers.reg00,lakers.reg01,lakers.reg02,lakers.reg03,lakers.reg04,
lakers.reg06,lakers.reg07,lakers.reg08,lakers.reg09,lakers.post85,
lakers.post86,lakers.post87,lakers.post88,lakers.post89,lakers.post00,
lakers.post01,lakers.post02,lakers.post03,lakers.post04,lakers.post06,
lakers.post07,lakers.post08,lakers.post09)
pistons <- merger(pistons.reg85,pistons.reg86,pistons.reg87,pistons.reg88,pistons.reg89,
pistons.reg00,pistons.reg02,pistons.reg03,pistons.reg04,pistons.reg05,
pistons.reg06,pistons.reg07,pistons.reg08,pistons.reg09,pistons.post85,
pistons.post86,pistons.post87,pistons.post88,pistons.post89,
pistons.post00,pistons.post02,pistons.post03,pistons.post04,pistons.post05,
pistons.post06,pistons.post07,pistons.post08,pistons.post09)
rockets <- merger(rockets.reg90,rockets.reg91,rockets.reg93,rockets.reg94,rockets.reg95,
rockets.reg96,rockets.reg97,rockets.reg98,rockets.reg99,rockets.post90,
rockets.post91,rockets.post93,rockets.post94,rockets.post95,
rockets.post96,rockets.post97,rockets.post98,rockets.post99)
spurs <- merger(spurs.reg00,spurs.reg01,spurs.reg02,spurs.reg03,spurs.reg04,spurs.reg05,
spurs.reg06,spurs.reg07,spurs.reg08,spurs.reg09,spurs.reg10,spurs.reg11,
spurs.reg12,spurs.reg13,spurs.reg14,spurs.reg15,spurs.reg16,spurs.reg17,
spurs.reg18,spurs.reg19,spurs.post00,spurs.post01,spurs.post02,spurs.post03,
spurs.post04,spurs.post05,spurs.post06,spurs.post07,spurs.post08,spurs.post09,
spurs.post10,spurs.post11,spurs.post12,spurs.post13,spurs.post14,
spurs.post15,spurs.post16,spurs.post17,spurs.post18,spurs.post19)
warriors <- merger(warriors.reg13,warriors.reg15,warriors.reg16,warriors.reg17,warriors.reg18,
warriors.post13,warriors.post15,warriors.post16,warriors.post17,
warriors.post18)
### Keeping only the players that played in playoffs ###
keep <- function(data){
temp <- data.frame()
reg <- filter(data,time=='regular')
post <- filter(data,time=='post')
for(i in 1:nrow(reg)){
for(j in 1:nrow(post)){
if(sum(reg[i,c(1,3)] == post[j,c(1,3)]) == 2){
temp <- rbind(temp,reg[i,])
}
}
}
for(i in 1:nrow(post)){
for(j in 1:nrow(reg)){
if(sum(post[i,c(1,3)] == reg[j,c(1,3)]) == 2){
temp <- rbind(temp,post[i,])
}
}
}
return(data.frame(temp, row.names = NULL))
}
bulls <- keep(bulls)
caveliers <- keep(caveliers)
celtics <- keep(celtics)
heat <- keep(heat)
jazz <- keep(jazz)
lakers <- keep(lakers)
pistons <- keep(pistons)
rockets <- keep(rockets)
spurs <- keep(spurs)
warriors <- keep(warriors)
tidy <- function(data){
output <- data.frame()
for(i in unique(data$player)){
for(j in unique(data$year)){
corr.year <- filter(data,player==i,year==j)
reg <- filter(corr.year,time=='regular')
post <- filter(corr.year,time=='post')
temp <- data.frame(player=reg$player,year=reg$year,RVORP= reg$TVORP, PVORP= post$TVORP)
output <- rbind(output,temp)
}
}
return(output)
}
tidy(bulls)
tidy(warriors)
bulls <- tidy(bulls)
caveliers <- tidy(caveliers)
celtics <- tidy(celtics)
heat <- tidy(heat)
jazz <- tidy(jazz)
lakers <- tidy(lakers)
pistons <- tidy(pistons)
rockets <- tidy(rockets)
spurs <- tidy(spurs)
warriors <- tidy(warriors)
### Saving all the team data ###
write.csv(bulls,'bulls.csv')
write.csv(caveliers,'caveliers.csv')
write.csv(celtics,'celtics.csv')
write.csv(heat,'heat.csv')
write.csv(jazz,'jazz.csv')
write.csv(lakers,'lakers.csv')
write.csv(pistons,'pistons.csv')
write.csv(rockets,'rockets.csv')
write.csv(spurs,'spurs.csv')
write.csv(warriors,'warriors.csv')
library(tidyverse)
library(ggplot2)
###########################
### Loading in the data ###
###########################
### Setting the directory of the data ####
setwd('/Users/matty/Documents/BYU/undergrad_research/merging')
### Loading in the data ###
bulls <- read.csv('bulls.csv')
celtics <- read.csv('celtics.csv')
jazz <- read.csv('jazz.csv')
rockets <- read.csv('rockets.csv')
warriors <- read.csv('warriors.csv')
caveliers <- read.csv('caveliers.csv')
heat <- read.csv('heat.csv')
lakers <- read.csv('lakers.csv')
pistons <- read.csv('pistons.csv')
spurs <- read.csv('spurs.csv')
### Setting directory of the file ###
setwd('/Users/matty/Documents/BYU/undergrad_research/stats')
jazz
scatt <- function(data,years=NULL){
if(is.null(years) == TRUE){
plot(data$RVORP,data$PVORP)
abline(0,1)
}
else{
temp <- filter(data, year == years)
plot(temp$PVORP,temp$PVORP)
abline(0,1)
}
}
scatt(warriors,2017)
warriors
scatt <- function(data,years=NULL){
if(is.null(years) == TRUE){
plot(data$RVORP,data$PVORP)
abline(0,1)
}
else{
temp <- filter(data, year == years)
plot(temp$RVORP,temp$PVORP)
abline(0,1)
}
}
scatt(warriors,2017)
filter(warriors,year==2017)
scatt(bulls,1998)
scatt(lakers,2002)
scatt(bulls)
scatt(jazz)
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp, aes(x = year, y = TVORP, color = time)) +
geom_point() +
geom_line(aes(group = time)) +
labs(title = "Player performance in the regular season vs post season")
}
player('curryst01',warriors)
warriors
player('mcgeeja01',warriors)
ggplot(warriors, aes(x = year, y= c(RVORP,PVORP))) +
geom_point()
ggplot(warriors, aes(x = year, y= c(PVORP))) +
geom_point()
temp <- filter(warriors, player=='curryst01')
ggplot(temp, aes(x = year, y= c(PVORP))) +
geom_point()
ggplot(temp) +
geom_point(aes(x = year, y= c(PVORP)))
temp <- filter(warriors, player=='curryst01')
ggplot(temp) +
geom_point(aes(x = year, y= PVORP, color = 'blue')) +
############################
### Creating My Analyses ###
############################
player('stockjo01',jazz)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP), color = 'blue') +
############################
### Creating My Analyses ###
############################
player('stockjo01',jazz)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP, color = 'blue')) +
############################
### Creating My Analyses ###
############################
player('stockjo01',jazz)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP, color = 'blue')) +
############################
### Creating My Analyses ###
############################
player('stockjo01',jazz)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP, color = 'blue'))
ggplot(temp) +
geom_point(aes(x = year, y= PVORP, color = 'blue')) +
geom_point(aes(x = year, y= RVORP))
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = 'blue') +
geom_point(aes(x = year, y= RVORP))
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = 'blue') +
geom_point(aes(x = year, y= RVORP), color = 'red')
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = 'blue') +
geom_point(aes(x = year, y= RVORP), color = 'red') +
geom_line(aes(x = year,y=PVORP),color='blue')
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = 'blue') +
geom_point(aes(x = year, y= RVORP), color = 'red') +
geom_line(aes(x = year,y=PVORP),color='blue') +
geom_line(aes(x = year,y=RVORP),color='red')
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = 'blue') +
geom_point(aes(x = year, y= RVORP), color = 'red') +
geom_line(aes(x = year,y=PVORP),color='blue') +
geom_line(aes(x = year,y=RVORP),color='red')
}
player('stockjo01',jazz)
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = 'navy') +
geom_point(aes(x = year, y= RVORP), color = 'maroon') +
geom_line(aes(x = year,y=PVORP),color='navy') +
geom_line(aes(x = year,y=RVORP),color='maroon')
}
player('stockjo01',jazz)
player <- function(play, team){
player <- function(play, team){
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = '#6364c3') +
geom_point(aes(x = year, y= RVORP), color = 'maroon') +
geom_line(aes(x = year,y=PVORP),color='navy') +
geom_line(aes(x = year,y=RVORP),color='maroon')
}
player('stockjo01',jazz)
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = '#6364c3') +
geom_point(aes(x = year, y= RVORP), color = 'maroon') +
geom_line(aes(x = year,y=PVORP),color='#6364c3') +
geom_line(aes(x = year,y=RVORP),color='maroon')
}
player('stockjo01',jazz)
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = '#6364c3') +
geom_point(aes(x = year, y= RVORP), color = 'maroon') +
geom_line(aes(x = year,y=PVORP),color='#6364c3') +
geom_line(aes(x = year,y=RVORP),color='maroon')
}
player('stockjo01',jazz)
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = '#6364c3') +
geom_point(aes(x = year, y= RVORP), color = '#a04040') +
geom_line(aes(x = year,y=PVORP),color='#6364c3') +
geom_line(aes(x = year,y=RVORP),color='#a04040')
}
player('stockjo01',jazz)
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = '#4140a0') +
geom_point(aes(x = year, y= RVORP), color = '#a04040') +
geom_line(aes(x = year,y=PVORP),color='#4140a0') +
geom_line(aes(x = year,y=RVORP),color='#a04040')
}
player('stockjo01',jazz)
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = '#2f2db8') +
geom_point(aes(x = year, y= RVORP), color = '#b82d2d') +
geom_line(aes(x = year,y=PVORP),color='#2f2db8') +
geom_line(aes(x = year,y=RVORP),color='#b82d2d')
}
player('stockjo01',jazz)
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = '#2f2db8') +
geom_point(aes(x = year, y= RVORP), color = '#c41a1a') +
geom_line(aes(x = year,y=PVORP),color='#2f2db8') +
geom_line(aes(x = year,y=RVORP),color='#c41a1a')
}
player('stockjo01',jazz)
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = '#2f2db8') +
geom_point(aes(x = year, y= RVORP), color = '#e13434') +
geom_line(aes(x = year,y=PVORP),color='#2f2db8') +
geom_line(aes(x = year,y=RVORP),color='#e13434')
}
player('stockjo01',jazz)
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp) +
geom_point(aes(x = year, y= PVORP),color = '#3d34e1') +
geom_point(aes(x = year, y= RVORP), color = '#e13434') +
geom_line(aes(x = year,y=PVORP),color='#3d34e1') +
geom_line(aes(x = year,y=RVORP),color='#e13434')
}
player('stockjo01',jazz)
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp) +
geom_point(aes(x = year, y= RVORP),color = '#3d34e1') +
geom_point(aes(x = year, y= PVORP), color = '#e13434') +
geom_line(aes(x = year,y=RVORP),color='#3d34e1') +
geom_line(aes(x = year,y=PVORP),color='#e13434')
}
player('stockjo01',jazz)
ggplot(warriors)+
geom_point(aes(x=RVORP,y=PVORP))
ggplot(warriors)+
geom_point(aes(x=RVORP,y=PVORP)) +
geom_abline(0,1)
ggplot(warriors)+
geom_point(aes(x=RVORP,y=PVORP)) +
geom_abline(aes(x = y))
ggplot(warriors)+
geom_point(aes(x=RVORP,y=PVORP)) +
geom_abline(intercept = 0,slope=1)
scatt <- function(data,years=NULL){
if(is.null(years) == TRUE){
ggplot(data)+
geom_point(aes(x=RVORP,y=PVORP)) +
geom_abline(intercept = 0,slope=1)
}
else{
temp <- filter(data, year == years)
ggplot(temp)+
geom_point(aes(x=RVORP,y=PVORP)) +
geom_abline(intercept = 0,slope=1)
}
}
scatt(bulls)
scatt(bulls,1998)
scatt(warriors,2017)
player <- function(play, team){
temp <- filter(team, player == play)
ggplot(temp) +
geom_point(aes(x = year, y= RVORP),color = '#3d34e1') +
geom_point(aes(x = year, y= PVORP), color = '#e13434') +
geom_line(aes(x = year,y=RVORP),color='#3d34e1') +
geom_line(aes(x = year,y=PVORP),color='#e13434')
}
player('stockjo01',jazz)
unique(celtics$player)
length(unique(celtics$player))
length(unique(jazz$player))
length(unique(lakers$player))
length(unique(spurs$player))
scatt <- function(data,years=NULL){
if(is.null(years) == TRUE){
ggplot(data)+
geom_point(aes(x=RVORP,y=PVORP)) +
geom_abline(intercept = 0,slope=1)
}
else{
temp <- filter(data, year == years)
ggplot(temp)+
geom_point(aes(x=RVORP,y=PVORP)) +
geom_abline(intercept = 0,slope=1, color='red')
}
}
scatt(warriors,2017)
scatt <- function(data,years=NULL){
if(is.null(years) == TRUE){
ggplot(data)+
geom_point(aes(x=RVORP,y=PVORP)) +
geom_abline(intercept = 0,slope=1, color='red')
}
else{
temp <- filter(data, year == years)
ggplot(temp)+
geom_point(aes(x=RVORP,y=PVORP)) +
geom_abline(intercept = 0,slope=1, color='red')
}
}
scatt(bulls)
player('onealsh01',lakers)
scatt(lakers,2002)
scatt(jazz,1998)
scatt(jazz)
player('maloneka01',jazz)
unique(jazz$player)
player('malonka01',jazz)
unique(spurs$player)
player('duncati01',spurs)
player('stockjo01',jazz)
max(spurs$RVORP)
max(spurs$PVORP)
max(warriors$PVORP)
max(warriors$RVORP)
max(bulls$RVORP)
max(bulls$PVORP)
max(celtics$PVORP)
max(celtics$RVORP)
max(heat$RVORP)
max(heat$PVORP)
max(pistons$PVORP)
max(pistons$RVORP)
max(rockets$RVORP)
max(rockets$PVORP)
min(rockets$PVORP)
min(spurs$PVORP)
min(jazz$PVORP)
scatt <- function(data,years=NULL,show=NULL){
if(is.null(years) == TRUE){
ggplot(data)+
geom_point(aes(x=RVORP,y=PVORP)) +
geom_abline(intercept = 0,slope=1, color='#e1dc34')
}
else{
temp <- filter(data, year == years)
ggplot(temp)+
geom_point(aes(x=RVORP,y=PVORP)) +
geom_abline(intercept = 0,slope=1, color='#e1dc34')
}
}
min(jazz$PVORP
)
scatt(warriors)
scatt <- function(data,years=NULL,show=NULL){
if(is.null(years) == TRUE){
ggplot(data)+
geom_point(aes(x=RVORP,y=PVORP), color = '#e1dc34') +
geom_abline(intercept = 0,slope=1, color='red')
}
else{
temp <- filter(data, year == years)
ggplot(temp)+
geom_point(aes(x=RVORP,y=PVORP), color = '#e1dc34') +
geom_abline(intercept = 0,slope=1, color='red')
}
}
scatt(warriors)
scatt <- function(data,years=NULL,show=NULL){
if(is.null(years) == TRUE){
ggplot(data)+
geom_point(aes(x=RVORP,y=PVORP), color = '#b5b11a') +
geom_abline(intercept = 0,slope=1, color='red')
}
else{
temp <- filter(data, year == years)
ggplot(temp)+
geom_point(aes(x=RVORP,y=PVORP), color = '#b5b11a') +
geom_abline(intercept = 0,slope=1, color='red')
}
}
scatt(warriors)
scatt <- function(data,years=NULL,show=NULL){
if(is.null(years) == TRUE){
ggplot(data)+
geom_point(aes(x=RVORP,y=PVORP), color = '#c8c41a') +
geom_abline(intercept = 0,slope=1, color='red')
}
else{
temp <- filter(data, year == years)
ggplot(temp)+
geom_point(aes(x=RVORP,y=PVORP), color = '#c8c41a') +
geom_abline(intercept = 0,slope=1, color='red')
}
}
scatt(warriors)
scatt <- function(data,years=NULL,show=NULL){
if(is.null(years) == TRUE){
ggplot(data)+
geom_point(aes(x=RVORP,y=PVORP), color = '#e8e301') +
geom_abline(intercept = 0,slope=1, color='red')
}
else{
temp <- filter(data, year == years)
ggplot(temp)+
geom_point(aes(x=RVORP,y=PVORP), color = '#e8e301') +
geom_abline(intercept = 0,slope=1, color='red')
}
}
scatt(heat)
scatt(heat)
